
# methodology for an entity
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

# we must first do Cdiscount 
# entity cdiscount.com
radical_for_base=cdiscount
current_ent=cdiscount.com
select keyword, url, search_position, search_volume, magasin, rayon, produit into cdiscount_pricing from pricing_keywords where domain='cdiscount.com';
CREATE INDEX ON cdiscount_pricing (keyword);
# we don't do cdiscount vs cdiscount 
# select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,amazon_PRICING.magasin as magasin, amazon_PRICING.rayon as rayon, amazon_PRICING.produit as produit, amazon_PRICING.keyword as am_keyword, amazon_PRICING.url as am_url, amazon_PRICING.search_volume as am_search_volume, amazon_PRICING.search_position as am_search_position INTO amazon_VS_CDISCOUNT_PRICING from amazon_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( amazon_PRICING.keyword=CDISCOUNT_PRICING.keyword);

# entity amazon.fr
radical_for_base=amazon
current_ent=amazon.fr
select keyword, url, search_position, search_volume, magasin, rayon, produit into amazon_pricing from pricing_keywords where domain='amazon.fr';
CREATE INDEX ON amazon_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,amazon_PRICING.magasin as magasin, amazon_PRICING.rayon as rayon, amazon_PRICING.produit as produit, amazon_PRICING.keyword as am_keyword, amazon_PRICING.url as am_url, amazon_PRICING.search_volume as am_search_volume, amazon_PRICING.search_position as am_search_position INTO amazon_VS_CDISCOUNT_PRICING from amazon_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( amazon_PRICING.keyword=CDISCOUNT_PRICING.keyword);


current_ent=aubert.com
radical_for_base=aubert
select keyword, url, search_position, search_volume, magasin, rayon, produit into aubert_pricing from pricing_keywords where domain='aubert.com';
CREATE INDEX ON aubert_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position, aubert_PRICING.magasin as magasin, aubert_PRICING.rayon as rayon, aubert_PRICING.produit as produit, aubert_PRICING.keyword as am_keyword, aubert_PRICING.url as am_url, aubert_PRICING.search_volume as am_search_volume, aubert_PRICING.search_position as am_search_position INTO aubert_VS_CDISCOUNT_PRICING from aubert_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( aubert_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=autourdebebe.com
radical_for_base=autourdebebe
select keyword, url, search_position, search_volume, magasin, rayon, produit into autourdebebe_pricing from pricing_keywords where domain='autourdebebe.com'];
CREATE INDEX ON autourdebebe.com_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,autourdebebe_PRICING.magasin as magasin, autourdebebe_PRICING.rayon as rayon, autourdebebe_PRICING.produit as produit, autourdebebe_PRICING.keyword as am_keyword, autourdebebe_PRICING.url as am_url, autourdebebe_PRICING.search_volume as am_search_volume, autourdebebe_PRICING.search_position as am_search_position INTO autourdebebe_VS_CDISCOUNT_PRICING from autourdebebe_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( autourdebebe_PRICING.keyword=CDISCOUNT_PRICING.keyword);

#current_ent=king-jouet.com
#radical_for_base=king-jouet
#select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
#CREATE INDEX ON 'radical_for_base'_pricing (keyword);
#select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=toysrus.fr
radical_for_base=toysrus
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=materiel.net
radical_for_base=materiel
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=pearl.fr
radical_for_base=pearl
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=ebay.fr
radical_for_base=ebay
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=rueducommerce.fr
radical_for_base=rueducommerce
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=conforama.fr
radical_for_base=conforama
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=darty.com
radical_for_base=darty
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=fnac.com
radical_for_base=fnac
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=priceminister.com
radical_for_base=priceminister
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=zalando.fr
radical_for_base=zalando
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=ldlc.com
radical_for_base=ldlc
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=boulanger.fr
radical_for_base=boulanger
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=french.alibaba.com
radical_for_base=alibaba
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);

current_ent=pixmania.fr
radical_for_base=pixmania
select keyword, url, search_position, search_volume, magasin, rayon, produit into 'radical_for_base'_pricing from pricing_keywords where domain=''current_ent''];
CREATE INDEX ON 'radical_for_base'_pricing (keyword);
select CDISCOUNT_PRICING.keyword as cd_keyword, CDISCOUNT_PRICING.url as cd_url, CDISCOUNT_PRICING.search_volume as cd_search_volume, CDISCOUNT_PRICING.search_position as cd_search_position,' radical_for_base '_PRICING.magasin as magasin, ' radical_for_base '_PRICING.rayon as rayon, ' radical_for_base '_PRICING.produit as produit, ' radical_for_base '_PRICING.keyword as am_keyword, ' radical_for_base '_PRICING.url as am_url, ' radical_for_base '_PRICING.search_volume as am_search_volume, ' radical_for_base '_PRICING.search_position as am_search_position INTO ' radical_for_base '_VS_CDISCOUNT_PRICING from ' radical_for_base '_PRICING LEFT OUTER JOIN CDISCOUNT_PRICING  on( 'radical_for_base'_PRICING.keyword=CDISCOUNT_PRICING.keyword);


